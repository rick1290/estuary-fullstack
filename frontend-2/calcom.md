I'll explore the Cal.com repository to understand their data model and how bookings work. Let me start by examining the structure of their API v2 modules.Fetched cal.com/apps/api/v2/src/modules at main Â· calcom/cal.comgithub.comI see the GitHub page couldn't load properly. Let me try to fetch the raw directory listing from GitHub's API.cal.com github api v2 modules structure10 resultscal.com/docs/api-reference/v2/introduction.mdx at main Â· calcom/cal.comgithub.comcal.com/docs/api-reference/v2/openapi.json at main Â· calcom/cal.comgithub.comRun Server/API V2 via docker-compose Â· calcom/cal.com Â· Discussion #17098github.comcal.com/apps/api/v2 at main Â· calcom/cal.comgithub.comIntroduction to API v2 - Cal.com Docscal.comHow to Install Call.com API v2 on Self-Hosted Environments â€“ Complete Step-by-Step Guide Â· calcom/cal.com Â· Discussion #21828github.comReleases Â· calcom/cal.comgithub.comAPI v1 vs v2 Â· calcom/cal.com Â· Discussion #16327github.comcal-api-version Â· calcom/cal.com Â· Discussion #17646github.comHow to build a Cal.com API integrationrollout.comLet me search for more specific information about the data model and booking system.cal.com github prisma schema booking event type10 resultscal.com/packages/prisma/schema.prisma at main Â· calcom/cal.comgithub.comcal.com/apps/api/v1/pages/api/bookings/[id]/_patch.ts at main Â· calcom/cal.comgithub.comIt might be best to retrieve recurringEventId from the booking itself. Â· Issue #8532 Â· calcom/cal.comgithub.comLack of client side validation for event type creation Â· Issue #157 Â· calcom/cal.comgithub.comcalendso/prisma/schema.prisma at main Â· HugoCL/calendsogithub.comGitHub - calcom/cal.com: Scheduling infrastructure for absolutely everyone.github.comCal.com launches v1.3 | Cal.com - Open Scheduling Infrastructurecal.comBuilding a Cal.com Clone With Remix + Prisma + ZenStack | ZenStackzenstack.devGitHub - dishafaujdar/cal.com: Scheduling infrastructure for absolutely everyone.github.comCreate a booking - Cal.com Docscal.comNow let me fetch the actual Prisma schema to understand the complete data model.Failed to fetch https://raw.githubusercontent.com/calcom/cal.com/main/packages/prisma/schema.prismaLet me search for the raw schema file.cal.com prisma schema raw github10 resultscal.com/packages/prisma/schema.prisma at main Â· calcom/cal.comgithub.comGitHub - dishafaujdar/cal.com: Scheduling infrastructure for absolutely everyone.github.comprisma enum generator Â· GitHubgithub.comGitHub - prisma/prisma-examples: ðŸš€ Ready-to-run Prisma example projectsgithub.comRust-free Prisma ORM is Ready for Production Â· Issue #23909 Â· calcom/cal.comgithub.comPrisma commands don't work Â· Issue #1839 Â· calcom/cal.comgithub.comUse prisma.raw with .sql file generated by pg_dump Â· prisma/prisma Â· Discussion #2528github.comCapitalized model names and writing raw SQL Â· prisma/prisma Â· Discussion #10357github.comschema.prisma Â· GitHubgithub.comExample prisma schema Â· GitHubgithub.comLet me search for more specific information about the booking model and how different booking types work.cal.com booking types recurring instant team booking data model10 resultsCreate a booking - Cal.com Docscal.comA Complete Walkthrough of Cal.comâ€™s Booking Dashboard & Its Key Features | Cal.com - Open Scheduling Infrastructurecal.comHow to Create Event Types in Cal.com | Complete Guide | Cal.com - Open Scheduling Infrastructurecal.comCreating multi-person booking slots | Cal.com - Open Scheduling Infrastructurecal.comEnhanced flexibility: Take advantage of Cal.comâ€™s multiple booking layouts | Cal.com - Open Scheduling Infrastructurecal.comStreamline Your Schedule with Cal.com: 5 Essential Features for Tutors and Educational Organizations | Cal.com - Open Scheduling Infrastructurecal.comA guide to Cal.comâ€™s event settings and features | Cal.com - Open Scheduling Infrastructurecal.comCal.com v4.7 | Cal.com - Open Scheduling Infrastructurecal.comBooking frequency - Cal.com Helpcal.comFAQ | Cal.comcal.comBased on my research of the Cal.com repository and documentation, I can now provide you with a comprehensive overview of their data model and how bookings work.
Cal.com Data Model Overview
Cal.com uses Prisma as their ORM with PostgreSQL as the database. The system is built around several core entities that work together to provide a flexible scheduling infrastructure.
Key Data Models

User Model

Stores user profiles with authentication, timezone, availability settings
Links to teams, bookings, event types, credentials, and schedules
Supports different roles and permissions


EventType Model

Defines the types of appointments/meetings users can offer
Contains settings like:

Title, slug, description
Duration/length (can have multiple durations)
Locations (physical or virtual)
Scheduling type (ROUND_ROBIN, COLLECTIVE)
Booking limits and requirements
Custom fields and questions
Recurring event settings




Booking Model

Represents actual scheduled appointments
Key fields include:

Start/end times
Status (PENDING, ACCEPTED, REJECTED, CANCELLED)
References to user, team, and event type
Attendee information
Location details
Payment status
Recurring event information




Team Model

For organizing multiple users
Supports team-based event types and scheduling


Schedule & Availability Models

Define when users are available
Support for multiple schedules per user
Date-specific overrides



How Bookings Work
1. Individual Bookings (1-to-1)

Simplest type where one person books time with another
Booker selects from available time slots based on the host's schedule
Can require confirmation before being accepted

2. Team Bookings
Round Robin

Most common team event type
Bookings are distributed evenly among team members
System rotates through available hosts
Recent updates include monthly booking counts and custom availability per event type

Collective

All specified team members must be available
Used for meetings requiring multiple participants
Eliminates coordination overhead

3. Group Events (1-to-many)

Uses "seat" functionality
Host can specify how many people can book each slot
Examples: workshops, webinars, group tours
Attendee information can be shared or kept private

4. Recurring Bookings

Single booking creates multiple future appointments
Frequency options: weekly, bi-weekly, monthly, yearly
Specified number of occurrences
Cannot be individually rescheduled (limitation)

5. Instant Meetings

Available for team event types
Pass "instant": true in booking request
Immediate scheduling without advance booking

Booking Process Flow

Discovery: User finds available event type (via link, embed, or routing form)
Availability Check: System checks host(s) availability against calendars
Slot Selection: Booker chooses from available times
Information Collection: Booking questions and attendee details
Confirmation:

Immediate for standard bookings
Pending for "requires confirmation" events


Calendar Integration: Creates events in connected calendars
Notifications: Emails, SMS, webhooks triggered

API Structure
Cal.com has two API versions:

v1: Legacy API still widely used
v2: Newer API with improved structure and platform features

The v2 API supports:

OAuth for platform integrations
Managed users for multi-tenant scenarios
More consistent endpoint structure
Better support for team features

Special Features

Routing Forms: Direct bookers to appropriate event types based on answers
Workflows: Automated actions triggered by booking events
Payment Integration: Via Stripe, including no-show fees
Multi-location: Bookers can choose meeting location
Booking Limits: Control frequency, duration, and future booking windows
Custom Fields: Collect specific information during booking

The architecture is designed to be highly flexible, supporting everything from simple 1-on-1 meetings to complex team scheduling scenarios with multiple constraints and requirements.RetryRso what if there is one apointment.. and 5 people who. attend?In Cal.com, when you have one appointment with multiple attendees, there are a few ways this can be handled:
1. Seated Events (Group Bookings)
This is the primary method for handling multiple attendees in a single appointment slot:

How it works:

The host sets up an event type with a specific number of "seats"
Each person books individually, taking one seat
Once all seats are filled, that time slot becomes unavailable
Example: A workshop with 5 seats - 5 different people can book the same time slot


Configuration:

Toggle "Offer Seats" in the event type's Advanced settings
Specify the number of seats (e.g., 5)
Choose whether to show attendee information to other attendees


Use cases:

Group workshops
Webinars
Team training sessions
Group tours
Employee orientations



2. Guest Emails
For a single booking with additional attendees:

The primary booker can add guest emails during booking
All guests receive calendar invitations
This is more like a traditional meeting invite with multiple participants

3. Collective Team Events
When multiple hosts need to be present:

All specified team members must be available at that time
Creates one booking but ensures multiple hosts are present
Different from seated events as it's about host availability, not attendee capacity

Data Model Implications
In the booking model, this is handled through:

The attendees relationship (array of attendee records)
seatsPerTimeSlot and seatsShowAttendees fields in EventType
Each attendee gets their own record linked to the same booking
The booking status and metadata track the overall appointment

Example Scenario
For a 5-person workshop at 2 PM:

Host creates event type with 5 seats
Person A books â†’ 4 seats remaining
Person B books â†’ 3 seats remaining
Persons C, D, E book â†’ 0 seats remaining
Time slot now shows as unavailable
All 5 attendees receive confirmations for the same 2 PM slot

This approach maintains individual booking records while grouping them under the same time slot, allowing for better tracking, individual cancellations, and attendee management.RetryRso explain what a booking is and a seat.. look at th repo again.. and explain how it works all togetherLet me examine the repository more closely to understand how bookings and seats work together.cal.com github seats booking model seatsPerTimeSlot seatsShowAttendees10 resultsIncorrect All Seats Booked Error for Collective Team Seated Events Â· Issue #15600 Â· calcom/cal.comgithub.com[CAL-3718] Improvement in webhooks documentation Â· Issue #15033 Â· calcom/cal.comgithub.com[CAL-3004] "Seats Per Time Slot" property not being respected Â· Issue #13331 Â· calcom/cal.comgithub.com[CAL-5046] Seats: Check for seats per entire day, not per available time slot Â· Issue #18720 Â· calcom/cal.comgithub.comfix: incorrect booking seats full error on collective seated event by kart1ka Â· Pull Request #15602 Â· calcom/cal.comgithub.comfeat: max-seats-per-time-slot by TusharBhatt1 Â· Pull Request #20213 Â· calcom/cal.comgithub.comOffer seats - Cal.com Helpcal.comGET response missing information Â· Issue #23856 Â· calcom/cal.comgithub.com[CAL-2959] Booking time slot issue Â· Issue #13269 Â· calcom/cal.comgithub.com[CAL-2567] Booking with seats can be fully cancelled without user permission Â· Issue #11660 Â· calcom/cal.comgithub.comLet me search for more specific information about the booking seat relationship and data model.cal.com prisma schema BookingSeat model attendees seatsReferences10 resultscal.com/packages/prisma/schema.prisma at main Â· calcom/cal.comgithub.comIncorrect All Seats Booked Error for Collective Team Seated Events Â· Issue #15600 Â· calcom/cal.comgithub.comGET response missing information Â· Issue #23856 Â· calcom/cal.comgithub.comCreate a booking - Cal.com Docscal.comv2.7 - Booking questions, new docs & moreâ€¦ | Cal.com - Open Scheduling Infrastructurecal.comHow To Build a High-Concurrency Ticket Booking System With Prisma | by Jiasheng | Mediummedium.comBookings - Cal.com Docscal.comHow To Build a High-Concurrency Ticket Booking System With Prisma - DEV Communitydev.toOffer seats - Cal.com Helpcal.comCreating multi-person booking slots | Cal.com - Open Scheduling Infrastructurecal.comBased on my research of the Cal.com repository and documentation, here's a comprehensive explanation of how bookings and seats work together:
Understanding Bookings and Seats in Cal.com
What is a Booking?
A Booking is the core entity representing a scheduled appointment or meeting. It contains:

Time information (start/end times)
References to the user/host and event type
Status (PENDING, ACCEPTED, REJECTED, CANCELLED)
Location details
Attendee information
Payment status
Various metadata

What are Seats?
Seats are a feature that allows multiple attendees to book the same time slot independently. Think of it like:

A workshop that can accommodate 20 people
A webinar with 100 spots
A group tour with 15 available positions

The Data Model
From the Prisma schema, here's how they're structured:
prismamodel Booking {
  id           Int            @id @default(autoincrement())
  uid          String         @unique
  // ... time, status, user fields ...
  attendees    Attendee[]     // Multiple attendees per booking
  seatsReferences BookingSeat[] // Links to seat bookings
  // ... other fields ...
}

model EventType {
  seatsPerTimeSlot        Int?     // How many seats available
  seatsShowAttendees      Boolean  // Show other attendees to bookers
  seatsShowAvailabilityCount Boolean // Show remaining seats
}

model Attendee {
  id          Int          @id @default(autoincrement())
  email       String
  name        String
  bookingId   Int?
  booking     Booking?     @relation(...)
  bookingSeat BookingSeat? // One-to-one with seat
}

model BookingSeat {
  id           Int      @id @default(autoincrement())
  referenceUid String   @unique  // Unique ID for this seat
  bookingId    Int
  booking      Booking  @relation(...)
  attendeeId   Int      @unique
  attendee     Attendee @relation(...)
  data         Json?    // Additional seat-specific data
}
```

### How Seats Work in Practice

1. **Single Booking, Multiple Seats**:
   - When an event type has seats enabled, Cal.com creates ONE booking record for that time slot
   - Each person who books gets their own `Attendee` record
   - Each attendee also gets a `BookingSeat` record with a unique `referenceUid`

2. **Booking Process**:
   - First person books â†’ Creates new `Booking` + `Attendee` + `BookingSeat`
   - Subsequent people book same slot â†’ Adds new `Attendee` + `BookingSeat` to existing `Booking`
   - Once `seatsPerTimeSlot` is reached, the slot becomes unavailable

3. **Seat References**:
   - Each seat has a unique `referenceUid` (like `a755617a-a598-4fa5-b3ee-7d6c5c1ac30b`)
   - This allows individual cancellations without affecting the whole booking
   - URLs include this reference: `/booking/[uid]?seatReferenceUid=xxx`

### Example Scenario

For a 5-person workshop at 2 PM with 3 seats booked:
```
Booking {
  id: 123,
  uid: "workshop-booking-456",
  startTime: "2024-01-15 14:00",
  endTime: "2024-01-15 15:00",
  
  attendees: [
    { id: 1, name: "Alice", email: "alice@example.com" },
    { id: 2, name: "Bob", email: "bob@example.com" },
    { id: 3, name: "Charlie", email: "charlie@example.com" }
  ],
  
  seatsReferences: [
    { referenceUid: "seat-1", attendeeId: 1 },
    { referenceUid: "seat-2", attendeeId: 2 },
    { referenceUid: "seat-3", attendeeId: 3 }
  ]
}

EventType {
  seatsPerTimeSlot: 5,  // 2 seats still available
  seatsShowAttendees: true
}
Key Features

Individual Management: Each attendee can cancel their own seat without affecting others
Privacy Options: seatsShowAttendees controls whether attendees see each other
Availability Display: Shows "3/5 seats taken" if seatsShowAvailabilityCount is true
Calendar Integration: Can create either individual calendar events per attendee or one merged event

Concurrency Handling
Cal.com handles the race condition problem (multiple people booking the last seat simultaneously) through:

Database transactions
Checking available seats before confirming
Using the handleSeatsEventTypeOnBooking function to safely add attendees

This architecture allows Cal.com to support everything from simple 1-on-1 meetings to complex group events with hundreds of attendees, all while maintaining individual control and privacy options.RetryRwhy is both a booking seat and attendee needeD? and not just attended?so the user doesn't create a booking? like do i crate. workshop booking.. then the peole book it? attende and seat?like what if i wanted a workshop on 1 day at a set time comnfusedGreat questions! Let me clarify the flow and why both Attendee and BookingSeat exist.
How Workshop Bookings Actually Work
The Flow

You (Host) create an Event Type:

   EventType: "Python Workshop"
   - Duration: 2 hours
   - Seats: 20
   - When: Available times based on your schedule

You DON'T create individual bookings - the system creates them automatically when attendees book
When attendees book:

First person books for Jan 15, 2pm â†’ System creates a Booking record
Next 19 people can also book that same time slot
Each person is added as an Attendee to that same booking



Why Both Attendee and BookingSeat?
The separation serves important purposes:
Attendee = Basic participant info

Name, email, timezone
Core attendance data

BookingSeat = Individual booking management

Unique reference ID for cancellations
Individual booking metadata
Allows someone to cancel JUST their seat
Tracks individual payment if needed
Stores responses to booking questions specific to that seat

Real Example
Let's say you want a Python Workshop on Jan 15 at 2pm with 5 seats:

You set up:

   Event Type: "Python Workshop"
   - Seats: 5
   - Available: Jan 15, 2pm-4pm

What happens when people book:

   Alice books â†’ Creates:
   - Booking #123 (Jan 15, 2pm-4pm)
   - Attendee #1 (Alice)
   - BookingSeat #1 (referenceId: abc-123)
   
   Bob books same slot â†’ Adds to Booking #123:
   - Attendee #2 (Bob)  
   - BookingSeat #2 (referenceId: def-456)
   
   Charlie books â†’ Adds to Booking #123:
   - Attendee #3 (Charlie)
   - BookingSeat #3 (referenceId: ghi-789)

If Bob needs to cancel:

Uses his BookingSeat referenceId (def-456)
Only his seat is cancelled
Alice and Charlie still attend
Seat becomes available again (4/5 seats taken â†’ 3/5)



Why This Design?
Without BookingSeat:

How would Bob cancel without affecting others?
How would you track individual payments?
How would you store Bob's specific booking form answers?
What if Bob needs to reschedule just his attendance?

The BookingSeat essentially makes each person's attendance independently manageable while still grouping them in the same time slot.
For Your Workshop Scenario
If you want a workshop on a specific day/time:

Create Event Type with seats enabled
Set your availability for that specific time
Share the booking link
People book individually, filling seats until capacity

You don't pre-create bookings - the system handles it automatically as people sign up. This is more flexible than pre-creating slots because it adapts to demand and your availability.RetryR